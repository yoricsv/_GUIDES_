---

layout: col-document
title: WSTG - Latest
tags: WSTG

---

{% include breadcrumb.html %}
# Тестирование ответа на контрольный вопрос

|ID          |
|------------|
|WSTG-ATHN-08|

## Обзор

Часто называемые «секретными» вопросами и ответами, контрольные вопросы и ответы часто используются для восстановления забытых паролей (см. [Тестирование функций смены или сброса пароля](09-Testing_for_Weak_Password_Change_or_Reset_Functionalities.md), в качестве дополнительной меры защиты к паролю).

Обычно они генерируются при создании учётной записи и требуют, чтобы пользователь выбрал один из заранее подготовленных вопросов и дал соответствующий ответ. Они могут позволять пользователю создавать свои собственные пары вопросов и ответов. Оба метода небезопасны. В идеале контрольные вопросы должны разрешать ответы, известные только пользователю, которые не могут быть угаданы или найдены кем-либо ещё. А это сложнее, чем кажется.

Контрольные вопросы и ответы полагаются на секретность ответа. Вопросы и ответы следует выбирать таким образом, чтобы ответы были известны только владельцу учётной записи. Однако, несмотря на то, что многие ответы могут быть не известны широкой публике, большинство вопросов, которые встречаются на web-сайтах, продвигают псевдо-приватные ответы.

### Заранее подготовленные вопросы

Большинство заранее подготовленных вопросов довольно просты по своей природе и могут привести к вскрытию тайны ответа. Например:

- Ответы могут быть известны членам семьи или близким друзьям пользователя, например. «Какая девичья фамилия вашей матери?», «Какая дата вашего рождения?»
- Ответы могут быть легко угадываемыми, например. «Какой твой любимый цвет?», «Какая твоя любимая футбольная команда?»
- Ответы могут быть подобраны перебором, например. «Как зовут вашего первого школьного учителя?» — ответ, вероятно, найдётся в каких-нибудь широко распространённых списках популярных имён, и, следовательно, может быть написана простая атака перебором.
- Ответы могут быть общедоступными, например. "Какой ваш любимый фильм?" — ответ можно легко найти на странице профиля пользователя в социальной сети.

### Самостоятельно созданные вопросы

Проблема с собственными вопросами пользователей заключается в том, что это позволяет им создавать совершенно несекретные вопросы или сразу обойти весь смысл наличия контрольного вопроса. Вот несколько примеров из реальной жизни, иллюстрирующих этот момент:

- «Сколько будет 1+1?»
- «Какое у тебя имя пользователя?»
- «Мой пароль — S3curIty!»

## Задачи тестирования

- Определить сложность вопросов и насколько они прямолинейны.
- Оценить возможные ответы пользователей и возможности их подбора.

## Как тестировать

### Тестирование недостатков в заранее подготовленных вопросах

Попробуйте получить список «секретных» вопросов, создав новую учётную запись или пройдя через процедуру «Я не помню свой пароль». Постарайтесь сформировать как можно больше вопросов, чтобы получить представление об их типе. Если какие-либо из вопросов попадают в описанные выше категории, они уязвимы для атак (угадываются, подбираются перебором, доступны в социальных сетях и т. д.).

### Проверка недостатков в вопросах, созданных самостоятельно

Попробуйте сформулировать контрольные вопросы при создании новой учётной записи, или настроив свойства восстановления пароля у имеющейся. Если система позволяет пользователю создавать собственные контрольные вопросы, она уязвима для несекретных вопросов. Если в системе применяются контрольные вопросы, созданные самостоятельно в функции «Забыл(а) пароль», и если имена пользователей можно подобрать (см. [Перебор и угадывание учётных записей пользователей](../03-Identity_Management_Testing/04-Testing_for_Account_Enumeration_and_Guessable_User_Account.md), то тестировщику должно быть легко перебрать набор созданных самостоятельно вопросов. Следует ожидать, что с помощью этого метода будет найдено несколько лёгких самостоятельно созданных вопросов.

### Тестирование ответов методом перебора

Используйте методы, описанные в разделе [Тестирование механизма блокировки](03-Testing_for_Weak_Lock_Out_Mechanism.md), чтобы определить, запускает ли ряд неправильно данных ответов механизм блокировки.

Первое, на что следует обратить внимание при попытке использования контрольных вопросов, — это количество вопросов, на которые необходимо ответить. Большинству приложений требуется, чтобы пользователь ответил всего на один вопрос, тогда как некоторые важные приложения могут потребовать от пользователя ответа на два или даже больше вопросов.

Следующий шаг — оценить сложность контрольных вопросов. Можно ли получить ответы простым поиском в Google или с помощью социальной инженерии? Вот пошаговое руководство для пентестера по использованию схемы секретных вопросов:

- Позволяет ли приложение конечному пользователю выбрать вопрос, на который нужно ответить? Если да, сосредоточьтесь на вопросах, которые имеют:

    - Общеизвестный ответ; например, что-то, что можно было бы найти с помощью простого запроса в поисковой системе.
    - Факты из жизни, например, «первый учитель» или другие факты, которые можно найти в соц.сетях.
    - Несколько вариантов ответов, например, «какой модели был ваш первый автомобиль». Эти вопросы имеют небольшой список возможных ответов, и, основываясь на статистике, злоумышленник мог бы ранжировать их от наиболее до наименее вероятных.

- Определите, если это возможно, сколько у вас догадок:
    - Допускает ли сброс пароля неограниченное количество попыток?
    - Есть ли период блокировки после нескольких неправильных ответов? Имейте в виду, что система блокировки сама по себе может стать проблемой, поскольку злоумышленник может использовать её для запуска атаки «отказ в обслуживании» против законных пользователей.
    - Выберите подходящий вопрос на основе анализа вышеперечисленных пунктов и определите наиболее вероятные ответы.

Ключом к успешной эксплуатации и обходу «секретных» вопросов является поиск вопроса или набора вопросов, дающих возможность легко найти ответы. Всегда ищите вопросы, которые могут дать вам наибольшие статистические шансы угадать правильный ответ, если вы абсолютно не уверены ни в одном из них. В конце концов, схема «секретных» вопросов надёжна ровно настолько, насколько сложен самый простой вопрос.

## Ссылки

- [Проклятие «секретного» вопроса](https://www.schneier.com/essay-081.html)
- [Памятка OWASP по «секретным» вопросам](https://cheatsheetseries.owasp.org/cheatsheets/Choosing_and_Using_Security_Questions_Cheat_Sheet.html)
