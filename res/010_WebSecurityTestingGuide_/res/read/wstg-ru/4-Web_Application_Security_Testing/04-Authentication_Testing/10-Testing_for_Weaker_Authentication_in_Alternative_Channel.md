---

layout: col-document
title: WSTG - Latest
tags: WSTG

---

{% include breadcrumb.html %}
# Тестирование аутентификации в альтернативных каналах

|ID          |
|------------|
|WSTG-ATHN-10|

## Обзор

Даже если основные механизмы аутентификации пользователей и не содержат уязвимостей, может оказаться, что они есть в существующих альтернативных каналах аутентификации для тех же учётных записей. Следует провести тесты для выявления таких альтернативных каналов и, в зависимости от области тестирования, выявить уязвимости.

Альтернативные каналы взаимодействия с пользователем могут быть использованы для обхода основного, или предоставления информации, которая затем может помочь в атаке на основной канал. Некоторые из этих каналов сами по себе могут быть отдельными web-приложениями, использующими разные имена хостов или пути. Например:

- Стандартный сайт
- Web-сайт, оптимизированный для мобильных или специальных устройств
- Web-сайт, оптимизированный для специальных возможностей
- Сайты для других стран и языков
- Параллельные web-сайты, использующие те же учётные записи пользователей (например, web-сайт, предлагающий другие функции той же организации, web-сайт партнера, на котором используются общие учётные записи пользователей)
- Разработка, тестирование, приёмка и прочие промежуточные версии стандартного web-сайта

Но также это могут быть и другие типы приложений или бизнес-процессов:

- Приложение для мобильных устройств
- Приложение для настольных ПК
- Операторы контакт-центра
- Интерактивный автоответчик или системы голосового меню

Обратите внимание, что основное внимание в этом тесте уделяется альтернативным каналам; некоторые варианты аутентификации могут отображаться как другой контент, доставляемый через тот же web-сайт, и почти наверняка попадут в область тестирования. Они здесь больше не обсуждаются и должны были быть идентифицированы во время сбора информации и первичного тестирования аутентификации. Например:

- Постепенное улучшение и ухудшение, меняющие функциональность сайта
- Использование сайта без файлов cookie
- Использование сайта без JavaScript
- Использование сайта без плагинов, таких как для Flash и Java

Даже если границы проекта не позволяют протестировать альтернативные каналы, их существование должно быть задокументировано. Они могут подорвать уверенность в механизмах аутентификации и потребовать дополнительного тестирования.

## Пример

Основной сайт `http://www.example.com` и функции аутентификации всегда выполняются на страницах, использующих TLS `https://www.example.com/myaccount/`.

Однако есть другой сайт, оптимизированный для мобильных устройств, который не использует TLS и имеет более слабый механизм восстановления пароля. `http://m.example.com/myaccount/`.

## Задачи тестирования

- Определить альтернативные каналы аутентификации.
- Оценить применяющиеся меры защиты и наличие обходных путей по альтернативным каналам.

## Как тестировать

### Разобраться с основным механизмом

Полностью протестируйте основные функции аутентификации web-сайта. Необходимо определить, как создаются и изменяются учётные записи, а также как восстанавливаются, сбрасываются или изменяются пароли. Кроме того, необходимо знать об отличиях при аутентификации пользователей с повышенными привилегиями и мерах защиты аутентификации. Эти предварительные приготовления необходимы, чтобы иметь возможность сравнивать их с альтернативными каналами.

### Определить другие каналы

Другие каналы можно найти, используя следующие методы:

- Чтение страниц сайта, особенно главной, контактов, справочных, статей поддержки и часто задаваемых вопросов, условий и положений, уведомлений о конфиденциальности, файлов robots.txt, sitemap.xml и т.п.
- Поиск в журналах HTTP-прокси, записанных во время предыдущих этапов сбора и тестирования информации, таких строк, как mobile, android, iOS, ipad, mobile app, e-reader, wireless, auth, sso, single-sign-on в URL-адресах и теле страниц.
- Используйте поисковые системы, чтобы найти разные web-сайты одной организации или использующие одно и то же доменное имя, которые имеют похожее содержание домашней страницы или механизмы аутентификации.

Для каждого возможного канала убедитесь, являются ли учётные записи пользователей общими для всех этих каналов и дают ли они доступ к тем же или аналогичным функциям.

### Инвентаризация функций аутентификации

Для каждого альтернативного канала, в котором используются общие учётные записи пользователей или функциональные возможности, определите, доступны ли все функции аутентификации основного канала и существует ли что-либо дополнительное. Может быть полезно создать таблицу, подобную приведённой ниже:

  | Основной | Мобильный | Контакт-центр | Сайт партнёра |
  |---------|---------|--------------|-----------------|
  | Регистрация| Да     |     -        |       -         |
  | Вход  | Да     |    Да       |    Да (SSO)     |
  | Выход |   -     |     -        |       -         |
  |Сброс пароля |   Да  |   Да   |       -         |
  | -       | Изменение пароля |   -  |       -         |

В этом примере мобильный сайт имеет дополнительную функцию Изменения пароля, но не предлагает Выхода из системы. Ограниченное количество задач можно также решить по телефону контакт-центра. Контакт-центры могут быть интересны, потому что их проверки при подтверждении личности могут быть слабее, чем на web-сайте, что позволяет использовать этот канал для атак на учётную запись пользователя.

Перечисляя каналы, стоит обратить внимание на то, как осуществляется управление сессиями, в случае пересечения между каналами (например, файлы cookie привязаны к одному и тому же имени родительского домена, одновременные сессии разрешены, но не в одном и том же канале).

### Анализ и тестирование

Альтернативные каналы должны быть упомянуты в отчёте о тестировании, даже если они помечены как «только для информации» или «за рамками проекта». В некоторых случаях область тестирования может включать альтернативные каналы (например, потому что это просто другой путь к целевому хосту) или они могут быть добавлены в проект после обсуждения с владельцами всех каналов. Если тестирование разрешено и санкционировано, то следует провести все остальные тесты аутентификации, описанные в этом руководстве, и сравнить их с основным каналом.

## Связанные тестовые примеры

Следует использовать тестовые примеры, приведённые во всех остальных тестах аутентификации.

## Меры защиты

Убедитесь, что ко всем каналам применяется единообразная политика аутентификации, чтобы они были одинаково хорошо защищены.
