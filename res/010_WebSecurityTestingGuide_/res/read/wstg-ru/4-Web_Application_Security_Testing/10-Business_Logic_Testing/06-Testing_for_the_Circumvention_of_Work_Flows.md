---

layout: col-document
title: WSTG - Latest
tags: WSTG

---

{% include breadcrumb.html %}
# Тестирование обхода потока операций

|ID          |
|------------|
|WSTG-BUSL-06|

## Обзор

Уязвимости потока операций (англ.: workflow) включают в себя все виды уязвимостей, которые позволяют злоумышленнику ненадлежащим образом использовать приложение/систему так, чтобы он мог обойти (не следовать) предусмотренному/предполагаемому потоку операций.

[Определение потока операций в Wikipedia](https://en.wikipedia.org/wiki/Workflow):

> Поток операций состоит из последовательности связанных этапов, где каждый этап идёт без задержек или промежутков и заканчивается непосредственно перед началом следующего. Это описание последовательности операций, которыми могут являться работа человека, группы или организации, а также одного или нескольких простых или сложных механизмов. Поток операций можно рассматривать как абстракцию реальной работы.

Бизнес-логика приложения должна требовать, чтобы пользователь выполнял предусмотренные этапы в правильном/заданном порядке, и если поток операций завершается некорректно, то все порождённые им события и действия «откатываются» или отменяются. Уязвимости, связанные с обходом заданного потока операций или нарушением логики бизнес-процесса, уникальны тем, что они очень специфичны для приложения/системы, и приходится разрабатывать сценарии некорректного использования вручную, с учётом требований и целевых сценариев использования.

В бизнес-процессе приложения должны быть проверки, гарантирующие, что транзакции/действия пользователя выполняются в правильном/допустимом порядке, и если транзакция инициирует какое-то действие, это действие будет «откатываться» и отменяться, если она не будет успешно завершена.

### Пример 1

Многие из нас получают так называемые «баллы программы лояльности» за покупки в продуктовых магазинах и на автозаправочных станциях. Предположим, пользователь смог начать транзакцию, а затем, после того как к его учётной записи были начислены баллы, отменил её или удалил товары из «корзины» и вышел. В этом случае система либо не должна начислять баллы на его счёт до тех пор, пока он не будет оплачен, либо баллы должны быть «отменены», если их прирост не соответствует окончательному расчёту. Имея это в виду, злоумышленник может начинать транзакции и отменять её, чтобы поднять свой уровень в программе, ничего фактически не покупая.

### Пример 2

Система электронной доски объявлений может быть спроектирована таким образом, чтобы первоначальные сообщения не содержали ненормативной лексики из списка, с которым сравнивается сообщение. Если в тексте, введённом пользователем, найдено слово из списка запрещённых, его сообщение не публикуется. Но после того, как сообщение опубликовано, его автор может получить к нему доступ, отредактировать и что-то изменить, чтобы добавить запрещённые слова из списка, поскольку при редактировании публикация уже не модерируется. Помня об этом, злоумышленник может начать исходно пустое или минимальное обсуждение, а затем добавить всё, что ему нравится, в качестве обновления.

## Задачи тестирования

- Проанализировать проектную документацию, чтобы найти способы пропустить или выполнить этапы процесса в порядке, отличном от предполагаемой приложением логики потока операций.
- Разработать сценарии нецелевого использования и попытаться обойти каждый найденный поток операций.

## Как тестировать

### Метод тестирования 1

- Вызовите транзакцию в приложении, которая, например, начисляет баллы на учётную запись пользователя.
- Отмените транзакцию или сократите её сумму, чтобы уменьшить количество баллов, и проверьте счёт в программе лояльности, чтобы убедиться, что баллы учтены правильно.

### Метод тестирования 2

- В системе управления контентом или на доске объявлений введите и сохраните допустимый первоначальный текст или значения.
- Затем попробуйте добавить, отредактировать или удалить данные, которые переведут уже имеющиеся данные в категорию недопустимых или с недопустимыми значениями, чтобы убедиться, что пользователю не разрешено сохранять некорректную информацию. Под категорию недопустимых могут подпадать те или иные слова (например, ненормативная лексика) или определённые темы (например, политические).

## Связанные сценарии тестирования

- [Тестирование включения файлов при обходе каталогов](../05-Authorization_Testing/01-Testing_Directory_Traversal_File_Include.md)
- [Тестирование обхода схемы авторизации](../05-Authorization_Testing/02-Testing_for_Bypassing_Authorization_Schema.md)
- [Тестирование схемы управления сессиями](../06-Session_Management_Testing/01-Testing_for_Session_Management_Schema.md)
- [Тестирование форматно-логического контроля данных](01-Test_Business_Logic_Data_Validation.md)
- [Тестирование способности подделывать запросы](02-Test_Ability_to_Forge_Requests.md)
- [Тестирование проверки целостности](03-Test_Integrity_Checks.md)
- [Тестирование времени обработки](04-Test_for_Process_Timing.md)
- [Тестирование ограничений на количество раз, которое функция может быть вызвана](05-Test_Number_of_Times_a_Function_Can_Be_Used_Limits.md)
- [Тестирование защиты от нецелевого использования приложений](07-Test_Defenses_Against_Application_Misuse.md)
- [Тестирование загрузки файлов непредусмотренных типов](08-Test_Upload_of_Unexpected_File_Types.md)
- [Тестирование загрузки вредоносных файлов](09-Test_Upload_of_Malicious_Files.md)

## Меры защиты

Приложение должно уметь контролировать, что пользователи выполняют каждый этап предусмотренного его логикой потока операций в правильном порядке, не допуская, чтобы злоумышленники могли обойти/пропустить/или повторять какие-либо этапы/процессы в потоке операций. Тестирование уязвимостей потока операций включает в себя разработку сценариев злоупотребления/нецелевого использования бизнес-логики с целью успешного завершения процесса, не выполняя предусмотренных этапов и не соблюдая их правильный порядок.

## Ссылки

- [OWASP Abuse Case Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Abuse_Case_Cheat_Sheet.html)
- [CWE-840: Business Logic Errors](https://cwe.mitre.org/data/definitions/840.html)
