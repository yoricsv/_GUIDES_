---

layout: col-document
title: WSTG - Latest
tags: WSTG

---

{% include breadcrumb.html %}
# Тестирование защиты от нецелевого использования приложений

|ID          |
|------------|
|WSTG-BUSL-07|

## Обзор

Злоупотребление и нецелевое использование допустимой функциональности может выявить атаки, пытающиеся просканировать web-приложение, выявить слабые места и эксплуатировать уязвимости. Следует провести тесты, чтобы определить, существуют ли механизмы на уровне приложений для защиты приложения.

Отсутствие активной защиты позволяет злоумышленнику искать уязвимости, не боясь быть обнаруженным. Таким образом, владелец приложения не будет знать, что его приложение подвергается атаке.

### Пример

Аутентифицированный пользователь выполняет следующую (маловероятную) последовательность действий:

1. Пытается получить доступ к идентификатору файла, загрузка которого не разрешена его роли.
2. Вместо идентификатора файла вставляет одинарную кавычку `'`.
3. Изменяет запрос GET на POST.
4. Вставляет дополнительный параметр.
5. Дублирует пару имя/значение параметра.

Приложение отслеживает случаи некорректного использования и после 5-го такого события реагирует, будучи абсолютно уверенным в том, что пользователь является злоумышленником. Например, приложение:

- Отключает критичные функции.
- Включает дополнительные этапы аутентификации для остальных функций.
- Добавляет временные задержки в каждый цикл запроса-ответа.
- Начинает фиксировать дополнительные данные о взаимодействии пользователя (например, нейтрализованные заголовки и тела HTTP-запросов и ответов).

Если приложение никоим образом не отвечает, а злоумышленник может продолжать злоупотреблять функциональностью и отправлять явно вредоносный контент в приложение, то оно не прошло этот тест. На практике указанные в приведённом выше примере действия вряд ли будут выполняться подобным образом. Гораздо более вероятно, что для выявления слабых мест в каждом параметре по очереди будет использоваться инструмент фаззинга. Этим же следует заниматься и тестировщику безопасности.

## Задачи тестирования

- Записывать заметки обо всех тестах, проводимых с системой.
- Проверить, для каких тестов в результате фаззинга функциональность отличалась от целевой.
- Изучить существующие меры защиты и проверить, достаточно ли их для защиты системы от методов обхода.

## Как тестировать

Этот тест необычен тем, что его результат может быть получен из других тестов, проведённых над web-приложением. При проведении этих тестов обращайте внимание на меры, которые могут указывать на то, что приложение имеет встроенную самозащиту:

- модифицированные ответы;
- заблокированные запросы;
- действия, которые приводят к выходу пользователя из системы или блокировке его учётной записи.

Они могут быть только локальными. Распространёнными локальными (для каждой функции) мерами защиты являются:

- отклонение входных данных, содержащих определённые символы;
- временная блокировка учетной записи после ряда сбоев аутентификации.

Локальных мер недостаточно. Часто нет никакой защиты от нецелевого использования общего характера, например:

- Принудительный просмотр (т.е. перебор web-ресурсов).
- Обход форматно-логического контроля входных данных приложения.
- Многократные ошибки управления доступом.
- Дополнительные, дублирующиеся или отсутствующие наименования параметров.
- Многократные ошибки контроля ввода или бизнес-логики со значениями, которые не могут быть результатом ошибок или опечаток пользователя.
- Получение структурированных данных (например, JSON, XML) недопустимого формата.
- Получение полезной нагрузки в виде очевидных межсайтовых скриптов или SQL-инъекций.
- Использование приложения быстрее, чем это было бы возможно без средств автоматизации.
- Изменение геолокации (континента) пользователя.
- Изменение агента пользователя (например, браузера).
- Доступ к этапам бизнес-процесса в неправильном порядке.
- Большое количество или высокая частота использования функций, специфичных для конкретного приложения (например, отправка кода ваучера, неудачные платежи по кредитной карте, загрузка файлов, выход из системы и т.д.).

Эти меры защиты лучше всего работают в аутентифицированной зоне приложения, хотя частота создания новых учётных записей или доступа к контенту (например, парсинга сайта) может быть полезна и в публичной зоне.

Приложению не обязательно контролировать всё вышеперечисленное, но, если ни одно из действий не отслеживается, то это проблема. Был ли какой-либо ответ на вышеуказанные действия при тестировании web-приложения? Если нет, тестировщик должен сообщить, что приложение, по-видимому, не имеет активных мер защиты от нецелевого использования. Примечание. Иногда возможно, что все ответы на обнаружение атаки остаются незаметными для пользователя (например, внесение изменений в журнал, усиление мониторинга, оповещения администраторов и проксирование запросов), поэтому уверенности в этом обнаружении гарантировать нельзя. На практике очень немногие приложения (или связанная с ними инфраструктура, например, WAF) обнаруживают такие виды некорректного использования.

## Связанные сценарии тестирования

Применимы все остальные сценарии тестирования.

## Меры защиты

Приложения должны реализовывать активную защиту для отражения атак злоумышленников.

## Ссылки

- [Software Assurance](https://www.cisa.gov/uscert/sites/default/files/publications/infosheet_SoftwareAssurance.pdf), US Department Homeland Security
- [IR 7684](https://csrc.nist.gov/publications/detail/nistir/7864/final) Common Misuse Scoring System (CMSS), NIST
- [Common Attack Pattern Enumeration and Classification](https://capec.mitre.org/) (CAPEC), The Mitre Corporation
- [OWASP AppSensor Project](https://owasp.org/www-project-appsensor/)
- [AppSensor Guide v2](https://owasp.org/www-pdf-archive/Owasp-appsensor-guide-v2.pdf), OWASP
- Watson C, Coates M, Melton J and Groves G, [Creating Attack-Aware Software Applications with Real-Time Defenses](https://pdfs.semanticscholar.org/0236/5631792fa6c953e82cadb0e7268be35df905.pdf), CrossTalk The Journal of Defense Software Engineering, Vol. 24, No. 5, Sep/Oct 2011
