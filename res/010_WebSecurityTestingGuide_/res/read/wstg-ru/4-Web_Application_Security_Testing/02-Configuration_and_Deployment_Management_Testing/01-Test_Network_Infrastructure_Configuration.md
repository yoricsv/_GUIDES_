---

layout: col-document
title: WSTG - Latest
tags: WSTG

---

{% include breadcrumb.html %}
# Анализ конфигурации сетевой инфраструктуры

|ID          |
|------------|
|WSTG-CONF-01|

## Обзор

Внутренняя сложность взаимосвязанной и разнородной инфраструктуры web-серверов, которая может включать сотни web-приложений, делает управление и анализ конфигураций основополагающим шагом в тестировании и развёртывании каждого отдельного приложения. Достаточно одной уязвимости, чтобы подорвать безопасность всей инфраструктуры, и даже небольшие и, казалось бы, незначительные проблемы могут перерасти в серьёзные риски для приложений на этом сервере. Для решения подобных проблем после определения архитектуры приложения крайне важно провести углубленный анализ конфигурации и известных проблем безопасности.

Управление конфигурацией инфраструктуры web-сервера очень важно для обеспечения безопасности самого приложения. Если такие элементы, как программное обеспечение web-сервера, серверы баз данных или серверы аутентификации, не протестированы и не защищены должным образом, они могут создать нежелательные риски или уязвимости, которые могут поставить под угрозу само приложение.

Например, уязвимость web-сервера, которая позволила бы удалённому нарушителю увидеть исходный код самого приложения (уязвимость, которая неоднократно возникала как на web-серверах, так и на серверах приложений), может скомпрометировать приложение, поскольку анонимные пользователи могут использовать информацию, найденную в исходном коде, в атаках на приложение или его пользователей.

Для тестирования инфраструктуры управления конфигурациями необходимо выполнить следующие действия:

- Определить компоненты, из которых состоит инфраструктура, чтобы понять, как они взаимодействуют с web-приложением и как влияют на его безопасность.
- Проанализировать все компоненты инфраструктуры, чтобы убедиться, что они не содержат известных уязвимостей.
- Провести обзор инструментов администрирования, используемых для обслуживания компонентов инфраструктуры.
- Проанализировать механизмы аутентификации, чтобы убедиться, что они удовлетворяют потребностям приложения и что внешние пользователи не могут манипулировать ими для получения доступа.
- Определить список портов, которые требуются приложению; изменения в этом списке должны контролироваться системой управления версиями.

После отображения компонентов инфраструктуры на  [архитектуре приложений](../01-Information_Gathering/10-Map_Application_Architecture.md) можно проанализировать конфигурацию каждого из них и протестировать на наличие известных уязвимостей.

## Задачи тестирования

- Проанализировать конфигурации приложений, развёрнутых в сети, и убедиться, что в них нет известных уязвимостей.
- Убедиться, что используемые фреймворки и платформы безопасны и не подвержены известным уязвимостям из-за неподдерживаемого программного обеспечения или установленных по умолчанию настроек и учётных данных.

## Как тестировать

### Известные уязвимости сервера

Уязвимости, обнаруженные в различных частях архитектуры приложения, будь то web-сервер или база данных, могут серьёзно скомпрометировать само приложение. Например, рассмотрим уязвимость сервера, которая позволяет удалённому неавторизованному пользователю загружать или даже заменять файлы на web-сервере. Эта уязвимость может поставить под угрозу приложение, поскольку нарушитель сможет как заменить приложение, так и добавить свой код, который повлияет на back-end серверы, поскольку будет выполняться наравне с легитимными приложениями.

Анализ уязвимостей сервера может оказаться сложной задачей, если тест на проникновение проводится вслепую (методом «чёрного ящика»). В этих случаях уязвимости приходится тестировать с удалённого сайта, как правило, с использованием автоматизированных инструментов. Однако тестирование некоторых уязвимостей может привести к непредсказуемым результатам на web-сервере, а тестирование других (например, тех, что непосредственно противодействуют атакам типа «отказ в обслуживании») может оказаться невозможным из-за остановки некоторых служб, вызванного обеспечением самой возможности проведения тестирования.

Некоторые автоматизированные инструменты будут показывать уязвимости на основе обнаруженной версии web-сервера. Это приводит как к ложноположительным, так и к ложноотрицательным результатам. С одной стороны, если версия web-сервера не отображается, то инструмент сканирования не пометит сервер как уязвимый, даже если это так. С другой, если поставщик программного обеспечения не меняет отображаемую версию web-сервера после фактического устранения уязвимостей, то сканер находит несуществующие уязвимости. Последний случай очень распространён, поскольку некоторые поставщики операционных систем выпускают только исправления безопасности, но не проводят полное обновление до последней версии. Так происходит в большинстве дистрибутивов GNU/Linux, таких как Debian, Red Hat или SuSE. В большинстве случаев сканирование уязвимостей в архитектуре приложения находит только уязвимости, связанные с «публичными» элементами архитектуры (такими как web-сервер), и, как правило, не может найти уязвимости, связанные с элементами, которые не подвергаются внешнему воздействию, такими как back-end аутентификации, базы данных или обратные прокси-серверы [1].

Наконец, не все поставщики программного обеспечения публично раскрывают уязвимости, и поэтому их недостатки не регистрируются в общедоступных базах данных уязвимостей [2]. Такая информация раскрывается только клиентам или публикуется с помощью исправлений, которые не содержат сопутствующих рекомендаций, что снижает полезность инструментов сканирования. Как правило, охват уязвимостей инструментами будет неплохим для более распространённых продуктов (таких как web-сервер Apache, Internet Information Server от Microsoft или Lotus Domino от IBM), но его не будет для менее известных продуктов.

Вот почему анализ уязвимостей лучше всего проводить, когда есть внутренняя информация об используемом программном обеспечении, с номерами версий и релизов, а также применённых исправлений. Таким образом тестировщик может получить информацию из первых уст; проанализировать, какие недостатки есть в архитектуре и как они могут повлиять на само приложение. Когда это возможно, эти уязвимости можно протестировать, чтобы определить их реальные последствия и обнаружить, смогут ли внешние средства защиты (такие как системы обнаружения или предотвращения вторжений) снизить или свести на нет вероятность успешной эксплуатации. Тестировщики, зная конфигурацию, могут даже прийти к выводу, что уязвимости нет, поскольку она затрагивает программный компонент, который не используется.

Также стоит отметить, что поставщики программного обеспечения иногда молча исправляют уязвимости и выпускают их в новых релизах. У разных поставщиков разные релизные циклы, которые определяются их возможностями по сопровождению устаревших версий. Тестировщик должен проанализировать риск, связанный с использованием версий, поддержка которых скоро прекратится или они уже не поддерживаются. Это важно, поскольку, если уязвимость обнаружится в версии, которая больше не поддерживается, никто может не узнать об этом. Раз версия не поддерживается, исправления к ней не планируются, то и в рекомендациях эта версия может быть не указана как уязвимая. Даже в том случае, если известно, что система уязвима, потребуется провести полное обновление до новой версии, что может привести к значительному простою или к необходимости полной переделки приложения из-за несовместимости с последней версией.

### Инструменты администрирования

Инфраструктура web-сервера требует наличия средств администрирования для обслуживания и обновления информации, используемой приложением. Эта информация включает в себя статичный контент (web-страницы, графические файлы), исходный код приложения, данные аутентификации пользователей и т.д. Эти инструменты будут отличаться в зависимости от используемого сайта, технологии или программного обеспечения. Например, некоторые web-серверы администрируются с помощью интерфейсов, которые сами по себе являются web-серверами (например, iPlanet), или с помощью простых текстовых файлов конфигурации (как в случае с Apache [3]) или использовать графический интерфейс операционной системы (как IIS от Microsoft или ASP.Net).

В большинстве случаев конфигурацией web-сервера управляют с помощью различных инструментов для работы с файлами: через FTP, WebDAV, сетевые файловые системы (NFS, CIFS) или другие механизмы. Очевидно, что операционная система компонентов архитектуры приложения, управляет ими с помощью своих инструментов. Приложения также могут иметь встроенные в них административные интерфейсы, которые используются для работы с данными самого приложения (пользователями, контентом и т.д.).

После обнаружения административных интерфейсов, используемых для управления различными частями архитектуры, важно их проанализировать, поскольку, если злоумышленник получит доступ к любому из них, он сможет скомпрометировать или повредить архитектуру приложения. Для этого важно:

- Определить механизмы, которые контролируют доступ к этим интерфейсам, и связанные с ними уязвимости. Эта информация может быть доступна в Интернете.
- Изменить имя пользователя и пароль по умолчанию.

Некоторые компании предпочитают не сами управлять всеми аспектами своих приложений на web-сервере, а поручить управлять контентом приложения подрядчику, который может либо предоставлять только часть контента (обновления новостей или рекламные акции), либо полностью управлять web-сервером (включая контент и код). Обычно в таких ситуациях административные интерфейсы доступны из Интернета, поскольку это дешевле, чем выделенная линия, которая соединит подрядчика с инфраструктурой приложений через интерфейс управления. В этой ситуации важно протестировать, могут ли административные интерфейсы быть уязвимыми для атак.

## Ссылки

- [1] WebSEAL, также известный как Tivoli Authentication Manager, является обратным прокси-сервером от IBM, который является частью платформы Tivoli.
- [2] Например, Bugtraq от Symantec, X-Force от ISS или National Vulnerability Database (NVD) от NIST.
- [3] Для Apache существуют инструменты администрирования с графическим интерфейсом (например, NetLoony), но они пока не получили широкого распространения.
