---

layout: col-document
title: WSTG - Latest
tags: WSTG

---

{% include breadcrumb.html %}
# Тестирование разрешений на доступ к файлам

|ID          |
|------------|
|WSTG-CONF-09|

## Обзор

 При настройке разрешений на доступ к ресурсу предоставление доступа более широкому кругу субъектов, чем требуется, может привести к раскрытию чувствительной информации или изменению этого ресурса теми, кому это не предназначалось. Это особенно опасно, когда ресурс связан с конфигурацией программы, исполнением или конфиденциальной информацией пользователя.

Наглядным примером является исполняемый файл, запускаемый неавторизованными пользователями. Другой пример: информация об учётной записи или значение токена для доступа к API, которые всё чаще встречаются в современных web- или микросервисах, может храниться в файле конфигурации, права на доступ к которому установлены по умолчанию для чтения всем. Подобные чувствительные данные могут быть раскрыты инсайдерами или удалённым злоумышленником, который скомпрометировал сервис с помощью других уязвимостей, но получил только привилегии обычного пользователя.

## Задачи тестирования

- Проанализировать и выявить возможности несанкционированного доступа к файлам.

## Как тестировать

В Linux для проверки прав доступа к файлу используется команда `ls`. В качестве альтернативы для рекурсивного перечисления прав доступа к файлам также можно использовать `namei`.

`$ namei -l /PathToCheck/`

Файлы и каталоги, для которых требуется проверка прав доступа, среди прочих включают:

- Web-файлы/каталоги
- Файлы/каталоги конфигураций
- Конфиденциальные файлы (зашифрованные данные, пароли, ключи)/каталоги
- Файлы журналов (журналы событий безопасности, журналы операций, журналы действий администратора)/каталоги
- Исполнимые файлы (скрипты, EXE, JAR, классы, PHP, ASP)/каталоги
- Файлы/каталоги баз данных
- Временные файлы/каталоги
- Загруженные файлы/каталоги

## Меры защиты

Установите корректные права доступа к файлам и каталогам, чтобы неавторизованные пользователи не смогли без необходимости получать доступ к критически важным ресурсам.

## Инструменты

- [Windows AccessEnum](https://technet.microsoft.com/en-us/sysinternals/accessenum)
- [Windows AccessChk](https://technet.microsoft.com/en-us/sysinternals/accesschk)
- [Linux namei](https://linux.die.net/man/1/namei)

## Ссылки

- [CWE-732: Некорректное назначение разрешений для критического ресурса](https://cwe.mitre.org/data/definitions/732.html)
