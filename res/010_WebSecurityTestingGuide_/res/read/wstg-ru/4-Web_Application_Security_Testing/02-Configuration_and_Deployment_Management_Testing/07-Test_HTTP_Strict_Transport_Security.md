---

layout: col-document
title: WSTG - Latest
tags: WSTG

---

{% include breadcrumb.html %}
# Тестирование HTTP Strict Transport Security (HSTS)

|ID          |
|------------|
|WSTG-CONF-07|

## Обзор

Функция cтрогой транспортной безопасности в HTTP (HTTP Strict Transport Security, HSTS) позволяет web-приложению информировать браузер с помощью специального заголовка ответа о том, что он никогда не должен устанавливать соединение с указанными серверами домена с незашифрованным HTTP. Вместо этого он должен автоматически устанавливать все запросы на подключение для доступа к сайту через HTTPS. Это также предотвращает переопределение пользователями ошибок сертификата.

Учитывая важность этой меры защиты, целесообразно убедиться, что web-сайт использует этот HTTP-заголовок, чтобы гарантировать, что все данные между web-браузером и сервером передаются в зашифрованном виде.

В HTTP-заголовке `Strict-Transport-Security` используются две директивы:

- `max-age` для указания количества секунд, в течение которых браузер должен автоматически преобразовывать все HTTP-запросы в HTTPS.
- `includeSubDomains`, чтобы указать, что все связанные поддомены также должны использовать HTTPS.
- `preload` (неофициальная), чтобы указать, что домен(ы) находится в списке(ах) предварительной загрузки, и что браузеры никогда не должны подключаться к ним без HTTPS.
    - Поддерживается всеми основными браузерами, но не является официальной частью спецификации. Дополнительную информацию см. на [hstspreload.org](https://hstspreload.org/).

Вот пример реализации заголовка HSTS:

`Strict-Transport-Security: max-age=31536000; includeSubDomains`

Необходимо проверить использование этого заголовка в web-приложении, чтобы выяснить, могут ли возникнуть следующие проблемы безопасности.:

- Злоумышленники прослушивают сетевой трафик и получают доступ к информации, передаваемой по незашифрованному каналу.
- Злоумышленники, применяют атаку «манипулятор посередине», из-за проблемы принятия сертификатов, которые не являются доверенными.
- Пользователи ошибочно вводят в браузере  адрес с HTTP вместо HTTPS, или пользователи нажимают на ссылку в web-приложении, которое ошибочно указывает на протокол HTTP.

## Задача тестирования

- Проанализировать наличие заголовка HSTS и убедиться в его работоспособности.

## Как тестировать

Наличие заголовка HSTS можно подтвердить, изучая ответ сервера через перехватывающий прокси-сервер или используя curl следующим образом:

```bash
$ curl -s -D- https://owasp.org | grep -i strict
Strict-Transport-Security: max-age=31536000
```

## Ссылки

- [OWASP HTTP Strict Transport Security](https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html)
- [Серия учебных пособий OWASP по Appsec - Эпизод 4: Strict Transport Security](https://www.youtube.com/watch?v=zEV3HOuM_Vw)
- [Спецификация HSTS](https://tools.ietf.org/html/rfc6797)
- [Включение HTTP Strict Transport Security в Apache](https://https.cio.gov/hsts/)
- [Включение HTTP Strict Transport Security в Nginx](https://www.nginx.com/blog/http-strict-transport-security-hsts-and-nginx/)
