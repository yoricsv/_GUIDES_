---

layout: col-document
title: WSTG - Latest
tags: WSTG

---

{% include breadcrumb.html %}
# Тестирование входящих HTTP-запросов

|ID          |
|------------|
|WSTG-INPV-16|

## Обзор

В этом разделе описывается, как отслеживать все входящие/исходящие HTTP-запросы как на стороне клиента, так и на стороне сервера. Целью этого тестирования является проверка наличия ненужных или подозрительных HTTP-запросов, отправляемых в фоновом режиме.

Большинство инструментов тестирования безопасности web-приложений (например, AppScan, BurpSuite, ZAP) действуют как HTTP-proxy. Это требует смены прокси в клиентском приложении или браузере. Методы тестирования, перечисленные ниже, в основном сосредоточены на том, как отслеживать HTTP-запросы без изменений на стороне клиента, что наиболее близко к сценарию промышленной эксплуатации.

## Задачи тестирования

- Отслеживать все входящие и исходящие HTTP-запросы к web-серверу, чтобы проверять подозрительные запросы.
- Отслеживать HTTP-трафик без изменений прокси-сервера браузера конечного пользователя или клиентского приложения.

## Как тестировать

### Обратный прокси

Бывают ситуации, когда мы хотели бы отслеживать все входящие HTTP-запросы на web-сервере, но не можем изменять конфигурацию со стороны браузера или приложения. В этом случае мы можем настроить обратный прокси со стороны web-сервера, чтобы отслеживать все входящие/исходящие запросы на web-сервере.

Для платформы Windows мы рекомендуем Fiddler. Он обеспечивает не только мониторинг, но и позволяет редактировать/отвечать на HTTP-запросы. Перейдите по [этой ссылке, чтобы узнать, как настроить Fiddler в качестве обратного прокси](http://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/UseFiddlerAsReverseProxy).

Для платформы Linux можно использовать [Charles Web Debugging Proxy](https://www.charlesproxy.com/).

Этапы тестирования:

1. Установите Fiddler или Charles на web-сервер.
2. Настройте Fiddler или Charles как обратный прокси.
3. Перехватите HTTP-трафик.
4. Изучите HTTP-трафик.
5. Для тестирования измените HTTP-запрос и воспроизведите изменённый.

### Перенаправление портов

Перенаправление портов — ещё один способ, позволяющий перехватывать HTTP-запросы без изменений на стороне клиента. Также можно использовать Charles в качестве прокси-сервера SOCKS для перенаправления портов или инструменты Port Forwarding. Это позволит перенаправлять весь входящий захваченный трафик на стороне клиента на порт web-сервера.

Этапы тестирования:

1. Установите Charles или перенаправление портов на другой компьютер или web-сервер.
2. Настройте Charles в качестве Socks-прокси для перенаправления портов.

### Захват сетевого трафика на уровне TCP

Этот метод отслеживает весь сетевой трафик на уровне TCP. Можно использовать инструменты TCPDump или WireShark. Однако эти инструменты не позволяют редактировать захваченный трафик и отправлять изменённые HTTP-запросы для тестирования. Для воспроизведения захваченных пакетов трафика (PCAP) можно использовать Ostinato.

Этапы тестирования:

1. Активируйте TCPDump или WireShark на web-сервере для захвата сетевого трафика.
2. Исследуйте захваченные файлы (PCAP).
3. Редактируйте файлы PCAP с помощью инструмента Ostinato при необходимости.
4. Отвечайте на HTTP-запросы.

Рекомендуется использовать Fiddler или Charles, поскольку эти инструменты могут перехватывать HTTP-трафик, а также легко редактировать/отвечать на изменённые HTTP-запросы. Кроме того, если web-трафик является HTTPS, для Wireshark потребуется импортировать закрытый ключ web-сервера для проверки тела HTTP-сообщения. В противном случае тело HTTP-сообщения захваченного трафика будет зашифровано.

## Инструменты

- [Fiddler](https://www.telerik.com/fiddler/)
- [TCPProxy](https://cossme.github.io/grinder/guide/tcpproxy.html)
- [Charles Web Debugging Proxy](https://www.charlesproxy.com/)
- [WireShark](https://www.wireshark.org/)
- [PowerEdit-Pcap](https://sourceforge.net/projects/powereditpcap/)
- [pcapteller](https://github.com/BlackArch/pcapteller)
- [replayproxy](https://github.com/sparrowt/replayproxy)
- [Ostinato](https://ostinato.org/)

## Ссылки

- [Charles Web Debugging Proxy](https://www.charlesproxy.com/)
- [Fiddler](https://www.telerik.com/fiddler/)
- [TCPDUMP](https://www.tcpdump.org/)
- [Ostinato](https://ostinato.org/)
