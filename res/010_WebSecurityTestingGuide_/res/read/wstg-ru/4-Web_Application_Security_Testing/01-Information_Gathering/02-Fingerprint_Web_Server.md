---

layout: col-document
title: WSTG - Latest
tags: WSTG

---

{% include breadcrumb.html %}
# Определение web-сервера

|ID          |
|------------|
|WSTG-INFO-02|

## Обзор

В задачу определения входит идентификация типа и версии web-сервера, на котором работает объект исследования. Хотя определение web-сервера часто входит в инструменты автоматизированного тестирования, исследователям важно понимать основы того, как эти инструменты пытаются идентифицировать программное обеспечение, и чем это может быть полезно.

Точное определение типа web-сервера, на котором работает приложение, может позволить специалистам по тестированию безопасности определить, уязвимо ли приложение для атаки. В частности, серверы со старыми версиями программного обеспечения без актуальных исправлений безопасности могут быть уязвимы для известных уязвимостей конкретной версии.

## Задача тестирования

- Определить версию и тип используемого web-сервера, чтобы на их основе провести обнаружение известных уязвимостей.

## Как тестировать

Методы, используемые для определения web-сервера, включают [захват баннера](https://en.wikipedia.org/wiki/Banner_grabbing), извлекая его из ответов на некорректные запросы и использование автоматизированных инструментов для выполнения более надёжного сканирования с применением комбинации тактик. Предпосылка, на которой основаны все эти методы, одна и та же. Все они пытаются получить ответ от web-сервера, который затем сравнивают с базой данных известных ответов и поведения и, таким образом, сопоставляют с известным типом сервера.

### Захват баннера

Захват баннера выполняется путём отправки HTTP-запроса на web-сервер и изучения его [заголовка ответа](https://developer.mozilla.org/en-US/docs/Glossary/Response_header). Это можно сделать с помощью различных инструментов, включая `telnet` для HTTP-запросов или `openssl` для запросов через SSL.

Например, вот ответ на запрос от сервера Apache.

```http
HTTP/1.1 200 OK
Date: Thu, 05 Sep 2019 17:42:39 GMT
Server: Apache/2.4.41 (Unix)
Last-Modified: Thu, 05 Sep 2019 17:40:42 GMT
ETag: "75-591d1d21b6167"
Accept-Ranges: bytes
Content-Length: 117
Connection: close
Content-Type: text/html
...
```

Вот ещё один ответ, на этот раз от nginx.

```http
HTTP/1.1 200 OK
Server: nginx/1.17.3
Date: Thu, 05 Sep 2019 17:50:24 GMT
Content-Type: text/html
Content-Length: 117
Last-Modified: Thu, 05 Sep 2019 17:40:42 GMT
Connection: close
ETag: "5d71489a-75"
Accept-Ranges: bytes
...
```

Вот как выглядит ответ от lighttpd.

```http
HTTP/1.0 200 OK
Content-Type: text/html
Accept-Ranges: bytes
ETag: "4192788355"
Last-Modified: Thu, 05 Sep 2019 17:40:42 GMT
Content-Length: 117
Connection: close
Date: Thu, 05 Sep 2019 17:57:57 GMT
Server: lighttpd/1.4.54
```

В этих примерах чётко указаны тип и версия сервера. Однако приложения, заботящиеся о безопасности, могут скрыть информацию о своём сервере, изменив заголовок. Например, вот выдержка из ответа на запрос для сайта с измененным заголовком:

```http
HTTP/1.1 200 OK
Server: Website.com
Date: Thu, 05 Sep 2019 17:57:06 GMT
Content-Type: text/html; charset=utf-8
Status: 200 OK
...
```

В случаях, когда информация о сервере скрыта, тестировщики могут угадать тип сервера на основе порядка полей заголовка. Обратите внимание, что в приведённом выше примере Apache поля идут в следующем порядке:

- Date
- Server
- Last-Modified
- ETag
- Accept-Ranges
- Content-Length
- Connection
- Content-Type

Однако как в примере с nginx, так и со скрытым сервером общие поля следуют в следующем порядке:

- Server
- Date
- Content-Type

Тестировщики могут использовать эту информацию, чтобы предположить, что скрытым сервером является nginx. Однако, учитывая, что разные web-сервера могут иметь одинаковый порядок полей, а сами поля могут быть изменены или удалены, этот метод не является определяющим.

### Отправка некорректных запросов

Web-сервер можно идентифицировать по сообщениям об ошибках. В случае, если такие сообщения не настраивались, это будут страницы ошибок по умолчанию. Один из способов заставить сервер представить их — отправить заведомо неправильные или искажённые запросы.

Например, вот ответ на запрос о несуществующем методе `SANTA CLAUS` от сервера Apache.

```http
GET / SANTA CLAUS/1.1


HTTP/1.1 400 Bad Request
Date: Fri, 06 Sep 2019 19:21:01 GMT
Server: Apache/2.4.41 (Unix)
Content-Length: 226
Connection: close
Content-Type: text/html; charset=iso-8859-1

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>400 Bad Request</title>
</head><body>
<h1>Bad Request</h1>
<p>Your browser sent a request that this server could not understand.<br />
</p>
</body></html>
```

Вот ответ на тот же запрос от nginx.

```html
GET / SANTA CLAUS/1.1


<html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx/1.17.3</center>
</body>
</html>
```

А вот ответ от lighttpd.

```http
GET / SANTA CLAUS/1.1


HTTP/1.0 400 Bad Request
Content-Type: text/html
Content-Length: 345
Connection: close
Date: Sun, 08 Sep 2019 21:56:17 GMT
Server: lighttpd/1.4.54

<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <title>400 Bad Request</title>
 </head>
 <body>
  <h1>400 Bad Request</h1>
 </body>
</html>
```

Поскольку страницы ошибок по умолчанию предлагают множество факторов, позволяющих различать типы web-серверов, их изучение может быть эффективным методом обнаружения, даже если поля http-заголовка сервера скрыты.

### Использование инструментов автоматизированного сканирования

Как указывалось ранее, определение web-сервера часто включается в функции автоматизированных инструментов сканирования. Эти инструменты могут делать запросы, подобные показанным выше, а также проводить другие более специфичные для сервера тесты. Автоматизированные инструменты могут сравнивать ответы web-серверов намного быстрее, чем ручное тестирование, и использовать большие базы данных известных ответов для попытки идентификации сервера. По этим причинам автоматизированные инструменты с большей вероятностью дадут точные результаты.

Вот некоторые часто используемые инструменты сканирования, которые включают в себя функцию определения web-сервера.

- [Netcraft](https://toolbar.netcraft.com/site_report) — online-инструмент, который сканирует web-сайты на наличие информации, включая web-сервер.
- [Nikto](https://github.com/sullo/nikto) — инструмент для командной строки с открытым исходным кодом.
- [Nmap](https://nmap.org/) — инструмент для командной строки с открытым исходным кодом, который также имеет графический интерфейс [Zenmap](https://nmap.org/zenmap/).

## Меры защиты

Хотя открытая информация о сервере не обязательно сама по себе является уязвимостью, это информация, которая может помочь злоумышленникам использовать другие уязвимости. Открытая информация о сервере также может привести к тому, что злоумышленники найдут уязвимости серверов конкретной версии, которые можно использовать для эксплуатации непропатченных серверов. По этой причине рекомендуется принять некоторые меры предосторожности, которые включают в себя:

- Сокрытие информации о web-сервере в http-заголовках, например, с помощью модуля [Apache mod_headers](https://httpd.apache.org/docs/current/mod/mod_headers.html).
- Использование защищённого [обратного прокси-сервера](https://en.wikipedia.org/wiki/Proxy_server#Reverse_proxies) для создания дополнительного уровня безопасности между web-сервером и Интернетом.
- Поддержание web-серверов в актуальном состоянии с помощью последних обновлений программного обеспечения и безопасности.
